{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"C:/webWork/olivertwist/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"C:/webWork/olivertwist/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useEffect,useState}from'react';import\"./MediaViewer.css\";import{useGlobalObj,globalObj}from'zergski-global';// content JSON\nimport mediaJSON from'logic/content-collections';// components\nimport Anchor from'shared/Anchor';// DEV PATH TO LOCALHOST\nvar localhost='http://192.168.0.149/brokenOT/IP/local/';mediaJSON.forEach(function(e){return e.src=localhost+e.src;});// console.log(mediaJSON)\n// DEV\nvar current='can1';var canvas={can1:{pos:'current',trans:true,source:mediaJSON[0].src},can2:{pos:'next',trans:true,source:mediaJSON[1].src},can3:{pos:'prev',trans:false,source:mediaJSON[mediaJSON.length-1].src}};// iterator\n// TODO! add settings\nvar iterator=function iterator(array,setState,initIndex){var index=initIndex;var count=array.length-1;// content count\nvar nextSource=index+2;// next image source to load\nreturn{next:function next(){index=index===count?0:++index;nextSource=index+1>count?0:index+1;Object.entries(canvas).forEach(function(c){canvas[c[0]].pos=c[1].pos==='current'?'prev':c[1].pos==='next'?'current':'next';c[1].pos==='current'&&(current=c[0]);if(c[1].pos==='next'){canvas[c[0]].trans=false;canvas[c[0]].source=mediaJSON[nextSource].src;}else{canvas[c[0]].trans=true;}});setState(_objectSpread(_objectSpread({},canvas),{},{counter:index+1}));},prev:function prev(){index=index===0?count:--index;nextSource=index-1<0?count:index-1;Object.entries(canvas).forEach(function(c){canvas[c[0]].pos=c[1].pos==='current'?'next':c[1].pos==='prev'?'current':'prev';c[1].pos==='current'&&(current=c[0]);if(c[1].pos==='prev'){canvas[c[0]].trans=false;canvas[c[0]].source=mediaJSON[nextSource].src;}else{canvas[c[0]].trans=true;}});setState(_objectSpread(_objectSpread({},canvas),{},{counter:index+1}));}};};var lastTouch=0;var content=Object.create(null);// component for viewing images, videos and documents\nvar MediaViewer=function MediaViewer(props){var MediaViewer={display:'hidden',contentIndex:0,initialState:{display:'hidden'}};var _useGlobalObj=useGlobalObj({MediaViewer:MediaViewer}),_useGlobalObj2=_slicedToArray(_useGlobalObj,1),viewerState=_useGlobalObj2[0];var _useState=useState(_objectSpread(_objectSpread({},canvas),{},{counter:1})),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState({touch:false,movement:0}),_useState4=_slicedToArray(_useState3,2),touchState=_useState4[0],setTouchState=_useState4[1];if(viewerState.display==='show'){// document.body.classList.add('scroll-lock');\nsetTimeout(function(){globalObj.MediaViewer.setState({display:'visible'});},50);}useEffect(function(){var display=viewerState.display,index=viewerState.index;if(display==='show'){content=iterator(mediaJSON,setState,index);current='can1';canvas={can1:{pos:'current',trans:false,source:mediaJSON[index].src},can2:{pos:'next',trans:false,source:mediaJSON[index===mediaJSON.length-1?0:index+1].src},can3:{pos:'prev',trans:false,source:mediaJSON[index===0?mediaJSON.length-1:index-1].src}};setState(_objectSpread(_objectSpread({},canvas),{},{counter:index+1}));}},[viewerState]);var handleClose=function handleClose(){globalObj.MediaViewer.setState({display:'hide'});setTimeout(function(){globalObj.MediaViewer.setState({display:'hidden'});},400);};// input handlers\nvar handleMovement=function handleMovement(delta){var touch=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var nextMovement=touchState.movement-delta;canvas[current].trans=false;canvas[current].movement=nextMovement;setTouchState({movement:nextMovement});};// touch\nvar handleTouchStart=function handleTouchStart(e){lastTouch=e.nativeEvent.touches[0].clientX;};var handleTouchMove=function handleTouchMove(e){var delta=lastTouch-e.nativeEvent.touches[0].clientX;lastTouch=e.nativeEvent.touches[0].clientX;handleMovement(Math.floor(delta),true);};var handleTouchEnd=function handleTouchEnd(e){touchState.movement<-50?content.next():touchState.movement>50&&content.prev();lastTouch=0;canvas[current].trans=true;setTouchState({movement:0});};return/*#__PURE__*/_jsxs(\"div\",{className:\"Media-Viewer \".concat(viewerState.display),onTouchStart:handleTouchStart,onTouchMove:handleTouchMove,onTouchEnd:handleTouchEnd,children:[/*#__PURE__*/_jsx(\"img\",{className:\"Media-Viewer-Content \".concat(state.can1.pos),alt:'',src:state.can1.source,style:{transform:current==='can1'?\"translateX(\".concat(touchState.movement,\"px)\"):'',transitionDuration:\"\".concat(canvas.can1.trans?'':'0s')}}),/*#__PURE__*/_jsx(\"img\",{className:\"Media-Viewer-Content \".concat(state.can2.pos),alt:'',src:state.can2.source,style:{transform:current==='can2'?\"translateX(\".concat(touchState.movement,\"px)\"):'',transitionDuration:\"\".concat(canvas.can2.trans?'':'0s')}}),/*#__PURE__*/_jsx(\"img\",{className:\"Media-Viewer-Content \".concat(state.can3.pos),alt:'',src:state.can3.source,style:{transform:current==='can3'?\"translateX(\".concat(touchState.movement,\"px)\"):'',transitionDuration:\"\".concat(canvas.can3.trans?'':'0s')}}),/*#__PURE__*/_jsxs(\"div\",{className:\"Modal-User-Interface-Wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Information-Box\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"\".concat(state.counter,\"/\").concat(mediaJSON.length)})}),/*#__PURE__*/_jsx(Anchor,{altClass:\"icon\",fileName:\"cross.svg\",style:{position:'absolute',top:'0',right:'0',opacity:'.5'},clicked:handleClose}),/*#__PURE__*/_jsx(Anchor,{altClass:\"icon\",fileName:\"arrow.svg\",style:{transform:'rotate(180deg)'},clicked:function clicked(){return content.prev();}}),/*#__PURE__*/_jsx(Anchor,{altClass:\"icon\",fileName:\"arrow.svg\",clicked:function clicked(){return content.next();}})]})]});};export default MediaViewer;","map":{"version":3,"sources":["C:/webWork/olivertwist/src/modals/MediaViewer.jsx"],"names":["React","useEffect","useState","useGlobalObj","globalObj","mediaJSON","Anchor","localhost","forEach","e","src","current","canvas","can1","pos","trans","source","can2","can3","length","iterator","array","setState","initIndex","index","count","nextSource","next","Object","entries","c","counter","prev","lastTouch","content","create","MediaViewer","props","display","contentIndex","initialState","viewerState","state","touch","movement","touchState","setTouchState","setTimeout","handleClose","handleMovement","delta","nextMovement","handleTouchStart","nativeEvent","touches","clientX","handleTouchMove","Math","floor","handleTouchEnd","transform","transitionDuration","position","top","right","opacity"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport \"./MediaViewer.css\";\nimport { useGlobalObj, globalObj } from 'zergski-global';\n\n// content JSON\nimport mediaJSON from 'logic/content-collections';\n\n// components\nimport Anchor from 'shared/Anchor';\n\n// DEV PATH TO LOCALHOST\nconst localhost = 'http://192.168.0.149/brokenOT/IP/local/';\nmediaJSON.forEach((e) => e.src = localhost + e.src );\n// console.log(mediaJSON)\n// DEV\n\n\n\n\n\nlet current = 'can1';\nlet canvas = {\n\tcan1: {\n\t\tpos: 'current',\n\t\ttrans: true,\n\t\tsource: mediaJSON[0].src,\n\t},\n\tcan2: {\n\t\tpos: 'next',\n\t\ttrans: true,\n\t\tsource: mediaJSON[1].src,\n\t},\n\tcan3: {\n\t\tpos: 'prev',\n\t\ttrans: false,\n\t\tsource: mediaJSON[mediaJSON.length-1].src,\n\t}\n}\n\n// iterator\n// TODO! add settings\nconst iterator = ( array, setState, initIndex ) => {\n\tlet index = initIndex;\n\tlet count = array.length - 1;\t// content count\n\tlet nextSource = index+2;\t\t// next image source to load\n\n\treturn {\n\t\tnext() {\n\t\t\tindex = index === count ? 0 : ++index;\n\t\t\tnextSource = index+1 > count ? 0 : index+1;\n\n\t\t\tObject.entries(canvas).forEach( c => {\n\t\t\t\tcanvas[c[0]].pos = c[1].pos === 'current' ? 'prev' : c[1].pos === 'next' ? 'current' : 'next';\n\t\t\t\tc[1].pos === 'current' && (current = c[0]);\n\t\t\t\tif ( c[1].pos === 'next' ) {\n\t\t\t\t\tcanvas[c[0]].trans = false;\n\t\t\t\t\tcanvas[c[0]].source = mediaJSON[nextSource].src;\n\t\t\t\t} else {\n\t\t\t\t\tcanvas[c[0]].trans = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetState({\n\t\t\t\t...canvas,\n\t\t\t\tcounter: index+1,\n\t\t\t});\n\t\t},\n\t\tprev() {\n\t\t\tindex = index === 0 ? count : --index;\n\t\t\tnextSource = index-1 < 0 ? count : index-1;\n\n\t\t\tObject.entries(canvas).forEach( c => {\n\t\t\t\tcanvas[c[0]].pos = c[1].pos === 'current' ? 'next' : c[1].pos === 'prev' ? 'current' : 'prev';\n\t\t\t\tc[1].pos === 'current' && (current = c[0]);\n\t\t\t\tif ( c[1].pos === 'prev' ) {\n\t\t\t\t\tcanvas[c[0]].trans = false;\n\t\t\t\t\tcanvas[c[0]].source = mediaJSON[nextSource].src;\n\t\t\t\t} else {\n\t\t\t\t\tcanvas[c[0]].trans = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetState({\n\t\t\t\t...canvas,\n\t\t\t\tcounter: index+1,\n\t\t\t});\n\t\t}\n\t}\n}\n\n\n\nvar lastTouch = 0;\nvar content = Object.create(null);\n\n// component for viewing images, videos and documents\nconst MediaViewer = props => {\n\tconst MediaViewer = {\n\t\tdisplay: 'hidden',\n\t\tcontentIndex: 0,\n\t\tinitialState: { display: 'hidden' },\n\t}\n\tconst [ viewerState ] = useGlobalObj({ MediaViewer });\n\tconst [ state, setState ] = useState({\n\t\t...canvas,\n\t\tcounter: 1,\n\t});\n\tconst [ touchState, setTouchState ] = useState({\n\t\ttouch: false,\n\t\tmovement: 0,\n\t});\n\n\n\n\n\tif ( viewerState.display === 'show' ) {\n\t\t// document.body.classList.add('scroll-lock');\n\t\tsetTimeout(()=>{\n\t\t\tglobalObj.MediaViewer.setState({ display: 'visible' });\n\t\t}, 50)\n\t}\n\n\tuseEffect(() => {\n\t\tconst { display, index } = viewerState;\n\t\tif ( display === 'show' ) {\n\t\t\tcontent = iterator( mediaJSON, setState, index );\n\n\t\t\tcurrent = 'can1';\n\t\t\tcanvas = {\n\t\t\t\tcan1: {\n\t\t\t\t\tpos: 'current',\n\t\t\t\t\ttrans: false,\n\t\t\t\t\tsource: mediaJSON[index].src,\n\t\t\t\t},\n\t\t\t\tcan2: {\n\t\t\t\t\tpos: 'next',\n\t\t\t\t\ttrans: false,\n\t\t\t\t\tsource: mediaJSON[index === mediaJSON.length-1 ? 0 : index+1].src,\n\t\t\t\t},\n\t\t\t\tcan3: {\n\t\t\t\t\tpos: 'prev',\n\t\t\t\t\ttrans: false,\n\t\t\t\t\tsource: mediaJSON[index === 0 ? mediaJSON.length-1 : index-1].src,\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetState({\n\t\t\t\t...canvas,\n\t\t\t\tcounter: index+1,\n\t\t\t})\n\t\t}\n\n\t}, [viewerState]);\n\n\tconst handleClose = () => {\n\t\tglobalObj.MediaViewer.setState({ display: 'hide' });\n\t\tsetTimeout(()=>{\n\t\t\tglobalObj.MediaViewer.setState({ display: 'hidden' });\n\t\t}, 400)\n\t}\n\n\n\n\t// input handlers\n\tconst handleMovement = ( delta, touch=false ) => {\n\t\tlet nextMovement = touchState.movement - delta;\n\n\n\t\tcanvas[current].trans = false;\n\t\tcanvas[current].movement = nextMovement;\n\t\tsetTouchState({ movement: nextMovement });\n\t}\n\t// touch\n\tconst handleTouchStart = (e) => {\n\t\tlastTouch = e.nativeEvent.touches[0].clientX;\n\t}\n\tconst handleTouchMove = (e) => {\n\t\tconst delta = lastTouch - e.nativeEvent.touches[0].clientX;\n\t\tlastTouch = e.nativeEvent.touches[0].clientX;\n\n\t\thandleMovement(Math.floor(delta), true);\n\t}\n\tconst handleTouchEnd = (e) => {\n\t\ttouchState.movement < -50 ? content.next() : touchState.movement > 50 && content.prev();\n\t\tlastTouch = 0;\n\n\t\tcanvas[current].trans = true;\n\t\tsetTouchState({ movement: 0 });\n\t}\n\n\treturn (\n\n\t\t<div className={ `Media-Viewer ${ viewerState.display }` }\n\t\t\tonTouchStart={ handleTouchStart }\n\t\t\tonTouchMove={ handleTouchMove }\n\t\t\tonTouchEnd={ handleTouchEnd }\n\t\t>\n\n\t\t\t<img className={ `Media-Viewer-Content ${ state.can1.pos }` } alt={ '' }\n\t\t\t\tsrc={ state.can1.source }\n\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: current === 'can1' ? `translateX(${ touchState.movement }px)` : '',\n\t\t\t\t\ttransitionDuration: `${ canvas.can1.trans ? '' : '0s' }`,\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<img className={ `Media-Viewer-Content ${ state.can2.pos }` } alt={ '' }\n\n\t\t\t\tsrc={ state.can2.source }\n\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: current === 'can2' ? `translateX(${ touchState.movement }px)` : '',\n\t\t\t\t\ttransitionDuration: `${ canvas.can2.trans ? '' : '0s' }`,\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<img className={ `Media-Viewer-Content ${ state.can3.pos }` } alt={ '' }\n\t\t\t\tsrc={ state.can3.source }\n\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: current === 'can3' ? `translateX(${ touchState.movement }px)` : '',\n\t\t\t\t\ttransitionDuration: `${ canvas.can3.trans ? '' : '0s' }`,\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<div className=\"Modal-User-Interface-Wrapper\">\n\t\t\t\t<div className=\"Information-Box\">\n\t\t\t\t\t<h4>{ `${ state.counter }/${ mediaJSON.length }` }</h4>\n\t\t\t\t</div>\n\t\t\t\t<Anchor\n\t\t\t\t\taltClass=\"icon\"\n\t\t\t\t\tfileName=\"cross.svg\"\n\t\t\t\t\tstyle={{ position: 'absolute', top: '0', right: '0', opacity: '.5' }}\n\t\t\t\t\tclicked={ handleClose }\n\t\t\t\t/>\n\t\t\t\t<Anchor\n\t\t\t\t\taltClass=\"icon\"\n\t\t\t\t\tfileName=\"arrow.svg\"\n\t\t\t\t\tstyle={{ transform: 'rotate(180deg)' }}\n\t\t\t\t\tclicked={ ()=>content.prev() }\n\t\t\t\t/>\n\t\t\t\t<Anchor\n\t\t\t\t\taltClass=\"icon\"\n\t\t\t\t\tfileName=\"arrow.svg\"\n\t\t\t\t\tclicked={ ()=>content.next() }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default MediaViewer;"]},"metadata":{},"sourceType":"module"}
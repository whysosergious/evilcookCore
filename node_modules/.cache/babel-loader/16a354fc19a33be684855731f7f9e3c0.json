{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\webWork\\\\evilcook\\\\src\\\\modals\\\\MediaViewer.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport \"./MediaViewer.css\";\nimport { useGlobalObj, globalObj } from 'zergski-global'; // content JSON\n\nimport mediaJSON from 'logic/content-collections'; // components\n\nimport Anchor from 'shared/Anchor'; // DEV PATH TO LOCALHOST\n\nconst localhost = 'http://192.168.0.149/brokenOT/IP/local/';\nmediaJSON.forEach(e => e.src = localhost + e.src); // console.log(mediaJSON)\n// DEV\n\nlet current = 'can1';\nlet canvas = {\n  can1: {\n    pos: 'current',\n    trans: true,\n    source: mediaJSON[0].src\n  },\n  can2: {\n    pos: 'next',\n    trans: true,\n    source: mediaJSON[1].src\n  },\n  can3: {\n    pos: 'prev',\n    trans: false,\n    source: mediaJSON[mediaJSON.length - 1].src\n  }\n}; // iterator\n// TODO! add settings\n\nconst iterator = (array, setState, initIndex) => {\n  let index = initIndex;\n  let count = array.length - 1; // content count\n\n  let nextSource = index + 2; // next image source to load\n\n  return {\n    next() {\n      index = index === count ? 0 : ++index;\n      nextSource = index + 1 > count ? 0 : index + 1;\n      Object.entries(canvas).forEach(c => {\n        canvas[c[0]].pos = c[1].pos === 'current' ? 'prev' : c[1].pos === 'next' ? 'current' : 'next';\n        c[1].pos === 'current' && (current = c[0]);\n\n        if (c[1].pos === 'next') {\n          canvas[c[0]].trans = false;\n          canvas[c[0]].source = mediaJSON[nextSource].src;\n        } else {\n          canvas[c[0]].trans = true;\n        }\n      });\n      setState({ ...canvas,\n        counter: index + 1\n      });\n    },\n\n    prev() {\n      index = index === 0 ? count : --index;\n      nextSource = index - 1 < 0 ? count : index - 1;\n      Object.entries(canvas).forEach(c => {\n        canvas[c[0]].pos = c[1].pos === 'current' ? 'next' : c[1].pos === 'prev' ? 'current' : 'prev';\n        c[1].pos === 'current' && (current = c[0]);\n\n        if (c[1].pos === 'prev') {\n          canvas[c[0]].trans = false;\n          canvas[c[0]].source = mediaJSON[nextSource].src;\n        } else {\n          canvas[c[0]].trans = true;\n        }\n      });\n      setState({ ...canvas,\n        counter: index + 1\n      });\n    }\n\n  };\n};\n\nvar lastTouch = 0;\nvar content = Object.create(null); // component for viewing images, videos and documents\n\nconst MediaViewer = props => {\n  _s();\n\n  const MediaViewer = {\n    display: 'hidden',\n    contentIndex: 0,\n    initialState: {\n      display: 'hidden'\n    }\n  };\n  const [viewerState] = useGlobalObj({\n    MediaViewer\n  });\n  const [state, setState] = useState({ ...canvas,\n    counter: 1\n  });\n  const [touchState, setTouchState] = useState({\n    touch: false,\n    movement: 0\n  });\n\n  if (viewerState.display === 'show') {\n    // document.body.classList.add('scroll-lock');\n    setTimeout(() => {\n      globalObj.MediaViewer.setState({\n        display: 'visible'\n      });\n    }, 50);\n  }\n\n  useEffect(() => {\n    const {\n      display,\n      index\n    } = viewerState;\n\n    if (display === 'show') {\n      content = iterator(mediaJSON, setState, index);\n      current = 'can1';\n      canvas = {\n        can1: {\n          pos: 'current',\n          trans: false,\n          source: mediaJSON[index].src\n        },\n        can2: {\n          pos: 'next',\n          trans: false,\n          source: mediaJSON[index === mediaJSON.length - 1 ? 0 : index + 1].src\n        },\n        can3: {\n          pos: 'prev',\n          trans: false,\n          source: mediaJSON[index === 0 ? mediaJSON.length - 1 : index - 1].src\n        }\n      };\n      setState({ ...canvas,\n        counter: index + 1\n      });\n    }\n  }, [viewerState]);\n\n  const handleClose = () => {\n    globalObj.MediaViewer.setState({\n      display: 'hide'\n    });\n    setTimeout(() => {\n      globalObj.MediaViewer.setState({\n        display: 'hidden'\n      });\n    }, 400);\n  }; // input handlers\n\n\n  const handleMovement = (delta, touch = false) => {\n    let nextMovement = touchState.movement - delta;\n    canvas[current].trans = false;\n    canvas[current].movement = nextMovement;\n    setTouchState({\n      movement: nextMovement\n    });\n  }; // touch\n\n\n  const handleTouchStart = e => {\n    lastTouch = e.nativeEvent.touches[0].clientX;\n  };\n\n  const handleTouchMove = e => {\n    const delta = lastTouch - e.nativeEvent.touches[0].clientX;\n    lastTouch = e.nativeEvent.touches[0].clientX;\n    handleMovement(Math.floor(delta), true);\n  };\n\n  const handleTouchEnd = e => {\n    touchState.movement < -50 ? content.next() : touchState.movement > 50 && content.prev();\n    lastTouch = 0;\n    canvas[current].trans = true;\n    setTouchState({\n      movement: 0\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `Media-Viewer ${viewerState.display}`,\n    onTouchStart: handleTouchStart,\n    onTouchMove: handleTouchMove,\n    onTouchEnd: handleTouchEnd,\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      className: `Media-Viewer-Content ${state.can1.pos}`,\n      alt: '',\n      src: state.can1.source,\n      style: {\n        transform: current === 'can1' ? `translateX(${touchState.movement}px)` : '',\n        transitionDuration: `${canvas.can1.trans ? '' : '0s'}`\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      className: `Media-Viewer-Content ${state.can2.pos}`,\n      alt: '',\n      src: state.can2.source,\n      style: {\n        transform: current === 'can2' ? `translateX(${touchState.movement}px)` : '',\n        transitionDuration: `${canvas.can2.trans ? '' : '0s'}`\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      className: `Media-Viewer-Content ${state.can3.pos}`,\n      alt: '',\n      src: state.can3.source,\n      style: {\n        transform: current === 'can3' ? `translateX(${touchState.movement}px)` : '',\n        transitionDuration: `${canvas.can3.trans ? '' : '0s'}`\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Modal-User-Interface-Wrapper\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"Information-Box\",\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: `${state.counter}/${mediaJSON.length}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Anchor, {\n        altClass: \"icon\",\n        fileName: \"cross.svg\",\n        style: {\n          position: 'absolute',\n          top: '0',\n          right: '0',\n          opacity: '.5'\n        },\n        clicked: handleClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Anchor, {\n        altClass: \"icon\",\n        fileName: \"arrow.svg\",\n        style: {\n          transform: 'rotate(180deg)'\n        },\n        clicked: () => content.prev()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Anchor, {\n        altClass: \"icon\",\n        fileName: \"arrow.svg\",\n        clicked: () => content.next()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 193,\n    columnNumber: 3\n  }, this);\n};\n\n_s(MediaViewer, \"Rj+6AoR+/ILiWdBzX4QNE8TRDxI=\", false, function () {\n  return [useGlobalObj];\n});\n\n_c = MediaViewer;\nexport default MediaViewer;\n\nvar _c;\n\n$RefreshReg$(_c, \"MediaViewer\");","map":{"version":3,"sources":["C:/webWork/evilcook/src/modals/MediaViewer.jsx"],"names":["React","useEffect","useState","useGlobalObj","globalObj","mediaJSON","Anchor","localhost","forEach","e","src","current","canvas","can1","pos","trans","source","can2","can3","length","iterator","array","setState","initIndex","index","count","nextSource","next","Object","entries","c","counter","prev","lastTouch","content","create","MediaViewer","props","display","contentIndex","initialState","viewerState","state","touchState","setTouchState","touch","movement","setTimeout","handleClose","handleMovement","delta","nextMovement","handleTouchStart","nativeEvent","touches","clientX","handleTouchMove","Math","floor","handleTouchEnd","transform","transitionDuration","position","top","right","opacity"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport \"./MediaViewer.css\";\nimport { useGlobalObj, globalObj } from 'zergski-global';\n\n// content JSON\nimport mediaJSON from 'logic/content-collections';\n\n// components\nimport Anchor from 'shared/Anchor';\n\n// DEV PATH TO LOCALHOST\nconst localhost = 'http://192.168.0.149/brokenOT/IP/local/';\nmediaJSON.forEach((e) => e.src = localhost + e.src );\n// console.log(mediaJSON)\n// DEV\n\n\n\n\n\nlet current = 'can1';\nlet canvas = {\n\tcan1: {\n\t\tpos: 'current',\n\t\ttrans: true,\n\t\tsource: mediaJSON[0].src,\n\t},\n\tcan2: {\n\t\tpos: 'next',\n\t\ttrans: true,\n\t\tsource: mediaJSON[1].src,\n\t},\n\tcan3: {\n\t\tpos: 'prev',\n\t\ttrans: false,\n\t\tsource: mediaJSON[mediaJSON.length-1].src,\n\t}\n}\n\n// iterator\n// TODO! add settings\nconst iterator = ( array, setState, initIndex ) => {\n\tlet index = initIndex;\n\tlet count = array.length - 1;\t// content count\n\tlet nextSource = index+2;\t\t// next image source to load\n\n\treturn {\n\t\tnext() {\n\t\t\tindex = index === count ? 0 : ++index;\n\t\t\tnextSource = index+1 > count ? 0 : index+1;\n\n\t\t\tObject.entries(canvas).forEach( c => {\n\t\t\t\tcanvas[c[0]].pos = c[1].pos === 'current' ? 'prev' : c[1].pos === 'next' ? 'current' : 'next';\n\t\t\t\tc[1].pos === 'current' && (current = c[0]);\n\t\t\t\tif ( c[1].pos === 'next' ) {\n\t\t\t\t\tcanvas[c[0]].trans = false;\n\t\t\t\t\tcanvas[c[0]].source = mediaJSON[nextSource].src;\n\t\t\t\t} else {\n\t\t\t\t\tcanvas[c[0]].trans = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetState({\n\t\t\t\t...canvas,\n\t\t\t\tcounter: index+1,\n\t\t\t});\n\t\t},\n\t\tprev() {\n\t\t\tindex = index === 0 ? count : --index;\n\t\t\tnextSource = index-1 < 0 ? count : index-1;\n\n\t\t\tObject.entries(canvas).forEach( c => {\n\t\t\t\tcanvas[c[0]].pos = c[1].pos === 'current' ? 'next' : c[1].pos === 'prev' ? 'current' : 'prev';\n\t\t\t\tc[1].pos === 'current' && (current = c[0]);\n\t\t\t\tif ( c[1].pos === 'prev' ) {\n\t\t\t\t\tcanvas[c[0]].trans = false;\n\t\t\t\t\tcanvas[c[0]].source = mediaJSON[nextSource].src;\n\t\t\t\t} else {\n\t\t\t\t\tcanvas[c[0]].trans = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetState({\n\t\t\t\t...canvas,\n\t\t\t\tcounter: index+1,\n\t\t\t});\n\t\t}\n\t}\n}\n\n\n\nvar lastTouch = 0;\nvar content = Object.create(null);\n\n// component for viewing images, videos and documents\nconst MediaViewer = props => {\n\tconst MediaViewer = {\n\t\tdisplay: 'hidden',\n\t\tcontentIndex: 0,\n\t\tinitialState: { display: 'hidden' },\n\t}\n\tconst [ viewerState ] = useGlobalObj({ MediaViewer });\n\tconst [ state, setState ] = useState({\n\t\t...canvas,\n\t\tcounter: 1,\n\t});\n\tconst [ touchState, setTouchState ] = useState({\n\t\ttouch: false,\n\t\tmovement: 0,\n\t});\n\n\n\n\n\tif ( viewerState.display === 'show' ) {\n\t\t// document.body.classList.add('scroll-lock');\n\t\tsetTimeout(()=>{\n\t\t\tglobalObj.MediaViewer.setState({ display: 'visible' });\n\t\t}, 50)\n\t}\n\n\tuseEffect(() => {\n\t\tconst { display, index } = viewerState;\n\t\tif ( display === 'show' ) {\n\t\t\tcontent = iterator( mediaJSON, setState, index );\n\n\t\t\tcurrent = 'can1';\n\t\t\tcanvas = {\n\t\t\t\tcan1: {\n\t\t\t\t\tpos: 'current',\n\t\t\t\t\ttrans: false,\n\t\t\t\t\tsource: mediaJSON[index].src,\n\t\t\t\t},\n\t\t\t\tcan2: {\n\t\t\t\t\tpos: 'next',\n\t\t\t\t\ttrans: false,\n\t\t\t\t\tsource: mediaJSON[index === mediaJSON.length-1 ? 0 : index+1].src,\n\t\t\t\t},\n\t\t\t\tcan3: {\n\t\t\t\t\tpos: 'prev',\n\t\t\t\t\ttrans: false,\n\t\t\t\t\tsource: mediaJSON[index === 0 ? mediaJSON.length-1 : index-1].src,\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetState({\n\t\t\t\t...canvas,\n\t\t\t\tcounter: index+1,\n\t\t\t})\n\t\t}\n\n\t}, [viewerState]);\n\n\tconst handleClose = () => {\n\t\tglobalObj.MediaViewer.setState({ display: 'hide' });\n\t\tsetTimeout(()=>{\n\t\t\tglobalObj.MediaViewer.setState({ display: 'hidden' });\n\t\t}, 400)\n\t}\n\n\n\n\t// input handlers\n\tconst handleMovement = ( delta, touch=false ) => {\n\t\tlet nextMovement = touchState.movement - delta;\n\n\n\t\tcanvas[current].trans = false;\n\t\tcanvas[current].movement = nextMovement;\n\t\tsetTouchState({ movement: nextMovement });\n\t}\n\t// touch\n\tconst handleTouchStart = (e) => {\n\t\tlastTouch = e.nativeEvent.touches[0].clientX;\n\t}\n\tconst handleTouchMove = (e) => {\n\t\tconst delta = lastTouch - e.nativeEvent.touches[0].clientX;\n\t\tlastTouch = e.nativeEvent.touches[0].clientX;\n\n\t\thandleMovement(Math.floor(delta), true);\n\t}\n\tconst handleTouchEnd = (e) => {\n\t\ttouchState.movement < -50 ? content.next() : touchState.movement > 50 && content.prev();\n\t\tlastTouch = 0;\n\n\t\tcanvas[current].trans = true;\n\t\tsetTouchState({ movement: 0 });\n\t}\n\n\treturn (\n\n\t\t<div className={ `Media-Viewer ${ viewerState.display }` }\n\t\t\tonTouchStart={ handleTouchStart }\n\t\t\tonTouchMove={ handleTouchMove }\n\t\t\tonTouchEnd={ handleTouchEnd }\n\t\t>\n\n\t\t\t<img className={ `Media-Viewer-Content ${ state.can1.pos }` } alt={ '' }\n\t\t\t\tsrc={ state.can1.source }\n\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: current === 'can1' ? `translateX(${ touchState.movement }px)` : '',\n\t\t\t\t\ttransitionDuration: `${ canvas.can1.trans ? '' : '0s' }`,\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<img className={ `Media-Viewer-Content ${ state.can2.pos }` } alt={ '' }\n\n\t\t\t\tsrc={ state.can2.source }\n\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: current === 'can2' ? `translateX(${ touchState.movement }px)` : '',\n\t\t\t\t\ttransitionDuration: `${ canvas.can2.trans ? '' : '0s' }`,\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<img className={ `Media-Viewer-Content ${ state.can3.pos }` } alt={ '' }\n\t\t\t\tsrc={ state.can3.source }\n\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: current === 'can3' ? `translateX(${ touchState.movement }px)` : '',\n\t\t\t\t\ttransitionDuration: `${ canvas.can3.trans ? '' : '0s' }`,\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<div className=\"Modal-User-Interface-Wrapper\">\n\t\t\t\t<div className=\"Information-Box\">\n\t\t\t\t\t<h4>{ `${ state.counter }/${ mediaJSON.length }` }</h4>\n\t\t\t\t</div>\n\t\t\t\t<Anchor\n\t\t\t\t\taltClass=\"icon\"\n\t\t\t\t\tfileName=\"cross.svg\"\n\t\t\t\t\tstyle={{ position: 'absolute', top: '0', right: '0', opacity: '.5' }}\n\t\t\t\t\tclicked={ handleClose }\n\t\t\t\t/>\n\t\t\t\t<Anchor\n\t\t\t\t\taltClass=\"icon\"\n\t\t\t\t\tfileName=\"arrow.svg\"\n\t\t\t\t\tstyle={{ transform: 'rotate(180deg)' }}\n\t\t\t\t\tclicked={ ()=>content.prev() }\n\t\t\t\t/>\n\t\t\t\t<Anchor\n\t\t\t\t\taltClass=\"icon\"\n\t\t\t\t\tfileName=\"arrow.svg\"\n\t\t\t\t\tclicked={ ()=>content.next() }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default MediaViewer;"]},"metadata":{},"sourceType":"module"}